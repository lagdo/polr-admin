function esc_selector(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")}jQuery.fn.clearForm=function(){return $(this).find("input").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected"),this};var dayData={},refererData={},countryData={},polr={home:{},stats:{leftBound:"",rightBound:""}};!function(a){function t(a){$("#tips").html(a)}function e(a){switch(a){case 1:t("Create an account to keep track of your links");break;case 2:t('Did you know you can change the URL ending by clicking on "Link Options"?'),i=1}}a.datatables={},a.jaxon=null,a.initTables=function(){var t={autoWidth:!1,processing:!0,serverSide:!0,drawCallback:function(){}};$("#admin_links_table").length&&(a.datatables.admin_links_table=$("#admin_links_table").DataTable($.extend({ajax:function(t,e,n){a.jaxon={callback:e,settings:n},a.getAdminLinks(t),a.jaxon=null},columns:[{className:"wrap-text",data:"short_url",name:"short_url"},{className:"wrap-text",data:"long_url",name:"long_url"},{data:"clicks",name:"clicks"},{data:"created_at",name:"created_at"},{data:"creator",name:"creator"},{data:"disable",name:"disable",orderable:!1,searchable:!1},{data:"delete",name:"delete",orderable:!1,searchable:!1}]},t))),a.datatables.user_links_table=$("#user_links_table").DataTable($.extend({ajax:function(t,e,n){a.jaxon={callback:e,settings:n},a.getUserLinks(t),a.jaxon=null},columns:[{className:"wrap-text",data:"short_url",name:"short_url"},{className:"wrap-text",data:"long_url",name:"long_url"},{data:"clicks",name:"clicks"},{data:"created_at",name:"created_at"}]},t))},a.reloadLinkTables=function(){"admin_links_table"in a.datatables&&a.datatables.admin_links_table.ajax.reload(null,!1),a.datatables.user_links_table.ajax.reload(null,!1)},a.init=function(){var t=$("#show-link-options");$("#options").hide();var n=0;t.click((function(){0===n?($("#options").slideDown(),n=1):($("#options").slideUp(),n=0)})),min=1,max=2;var r=Math.floor(Math.random()*(max-min+1))+min;e(r);setInterval((function(){e(r),r++}),8e3);$(".admin-nav a").click((function(a){a.preventDefault(),$(this).tab("show")})),a.initTables()}}(polr.home);var parseInputDate=function(a){return moment(a)};!function(a){a.short_url="",a.requestCallbacks={timers:[],onRequest:function(){$("#stats-buttons .btn-refresh-stats").prepend('<i class="fa fa-spinner fa-spin" />')},onFailure:function(){$("#stats-buttons .btn-refresh-stats i").remove()},onSuccess:function(){$("#stats-buttons .btn-refresh-stats i").remove()}},a.populateEmptyDayData=function(){var t=moment(a.rightBound).diff(moment(a.leftBound),"days"),e=moment(a.leftBound),n={};_.each(a.dayData,(function(a){var t=a.x;n[t]=!0})),_.each(_.range(0,t),(function(){var t=e.format("YYYY-MM-DD");t in n||a.dayData.push({x:t,y:0}),e.add(1,"day")})),a.dayData=_.sortBy(a.dayData,["x"])},a.initDayChart=function(){var t=$("#dayChart");a.populateEmptyDayData(),a.dayChart=new Chart(t,{type:"line",data:{datasets:[{label:"Clicks",data:a.dayData,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)"}]},options:{scales:{xAxes:[{type:"time",time:{unit:"day"}}],yAxes:[{ticks:{min:0}}]}}})},a.initRefererChart=function(){var t=$("#refererChart"),e=[],n=["#003559","#162955","#2E4272","#4F628E","#7887AB","#b9d6f2"],r=[];_.each(a.refererData,(function(a){if(e.length>6)return e[6]="Other",r[6]+=a.clicks,void(n[6]="brown");e.push(a.label),r.push(a.clicks)})),a.refererChart=new Chart(t,{type:"pie",data:{labels:e,datasets:[{data:r,backgroundColor:n}]}}),$("#refererTable").DataTable()},a.initCountryChart=function(){var t={};_.each(a.countryData,(function(a){t[a.label]=a.clicks})),$("#mapChart").vectorMap({map:"world_mill",series:{regions:[{values:t,scale:["#C8EEFF","#0071A4"],normalizeFunction:"polynomial"}]},onRegionTipShow:function(a,e,n){e.html(e.html()+" ("+(t[n]||0)+")")}})},a.initDatePickers=function(){var t=$("#left-bound-picker"),e=$("#right-bound-picker"),n={showTodayButton:!0,format:"YYYY-MM-DD HH:mm"};t.datetimepicker(n),e.datetimepicker(n),t.data("DateTimePicker").parseInputDate(parseInputDate),e.data("DateTimePicker").parseInputDate(parseInputDate),t.data("DateTimePicker").date(a.leftBound,Date,moment,null),e.data("DateTimePicker").date(a.rightBound,Date,moment,null)},a.initData=function(t,e,n,r,i){dayData=t,refererData=e,countryData=n,a.leftBound=r,a.rightBound=i},a.initCharts=function(){a.dayChart=null,a.refererChart=null,a.countryChart=null,a.dayData=dayData,a.refererData=refererData,a.countryData=countryData,a.initDayChart(),a.initRefererChart(),a.initCountryChart()},a.init=function(){a.initCharts(),a.initDatePickers()}}(polr.stats);